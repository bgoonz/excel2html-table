<h1 id="printj">printj</h1>
<p>Extended <code>sprintf</code> implementation (for the browser and nodejs). Emphasis on compliance, performance and IE6+ support.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="va">PRINTJ</span>.<span class="at">sprintf</span>(<span class="st">&quot;Hello %s!&quot;</span><span class="op">,</span> <span class="st">&quot;World&quot;</span>)<span class="op">;</span></a></code></pre></div>
<p>A self-contained specification of the printf format string is included below in <a href="#printf-format-string-specification">this README</a>, as well as a summary of the <a href="#support-summary">support against various printf implementations</a></p>
<h2 id="installation">Installation</h2>
<p>With <a href="https://www.npmjs.org/package/printj">npm</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1">$ <span class="ex">npm</span> install printj</a></code></pre></div>
<p>In the browser:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;printj.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a></code></pre></div>
<p>The browser exposes a variable <code>PRINTJ</code></p>
<p>When installed globally, npm installs a script <code>printj</code> that renders the format string with the given arguments. Running the script with <code>-h</code> displays help.</p>
<p>The script will manipulate <code>module.exports</code> if available (e.g. in a CommonJS <code>require</code> context). This is not always desirable. To prevent the behavior, define <code>DO_NOT_EXPORT_PRINTJ</code></p>
<h2 id="usage">Usage</h2>
<p>In all cases, the relevant function takes a format and arguments to be rendered.</p>
<p>The return value is a JS string.</p>
<ul>
<li><p><code>PRINTJ.sprintf(format, ...args)</code> assumes the arguments are passed directly</p></li>
<li><p><code>PRINTJ.vsprintf(format, argv)</code> assumes the arguments are passed in an array</p></li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="op">&gt;</span> <span class="co">// var PRINTJ = require(&#39;printj&#39;);       // uncomment this line if in node</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="op">&gt;</span> <span class="kw">var</span> sprintf <span class="op">=</span> <span class="va">PRINTJ</span>.<span class="at">sprintf</span><span class="op">,</span> vsprintf <span class="op">=</span> <span class="va">PRINTJ</span>.<span class="at">vsprintf</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="op">&gt;</span> <span class="at">sprintf</span>(<span class="st">&quot;Hello %s&quot;</span><span class="op">,</span> <span class="st">&quot;SheetJS&quot;</span>)           <span class="co">// &#39;Hello SheetJS&#39;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="op">&gt;</span> <span class="at">sprintf</span>(<span class="st">&quot;%d + %d = %d&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>)         <span class="co">// &#39;2 + 3 = 5&#39;</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="op">&gt;</span> <span class="at">vsprintf</span>(<span class="st">&quot;%d + %d = %d&quot;</span><span class="op">,</span> [<span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">5</span>])        <span class="co">// &#39;2 + 3 = 5&#39;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="op">&gt;</span> <span class="at">sprintf</span>(<span class="st">&quot;%1$02hhx %1$u %1$i %1$o&quot;</span><span class="op">,</span> <span class="dv">-69</span>)  <span class="co">// &#39;bb 4294967227 -69 37777777673&#39;</span></a></code></pre></div>
<p>The command line script takes a format and arguments:</p>
<pre><code>usage: printj [options] &lt;format&gt; [args...]

Options:
    -h, --help      output usage information
    -d, --dump      print debug information about format string

Arguments are treated as strings unless prefaced by a type indicator:
    n:&lt;integer&gt;     call parseInt (ex. n:3 -&gt; 3)
    f:&lt;float&gt;       call parseFloat (ex. f:3.1 -&gt; 3.1)
    b:&lt;boolean&gt;     false when lowercase value is &quot;FALSE&quot; or &quot;0&quot;, else true
    s:&lt;string&gt;      interpret as string (ex. s:n:3 -&gt; &quot;n:3&quot;)
    j:&lt;JSON&gt;        interpret as an object using JSON.parse
    e:&lt;JS&gt;          evaluate argument (ex. e:1+1 -&gt; 2, e:&quot;1&quot;+1 -&gt; &quot;11&quot;)

samples:
    $ printj &#39;|%02hhx%d|&#39; n:50 e:0x7B                # |32123|
    $ printj &#39;|%2$d + %3$d is %1$d|&#39; e:1+2 n:1 n:2   # |1 + 2 is 3|
    $ printj &#39;|%s is %s|&#39; s:1+2 e:1+2                # |1+2 is 3|
    $ printj &#39;|%c %c|&#39; s:69 n:69                     # |6 E|</code></pre>
<h2 id="testing">Testing</h2>
<p><code>make test</code> will run the nodejs-based test.</p>
<p><code>make stress</code> will run a larger test encompassing every possible conversion. It requires access to a C compiler.</p>
<h2 id="license">License</h2>
<p>Please consult the attached LICENSE file for details. All rights not explicitly granted by the Apache 2.0 license are reserved by the Original Author.</p>
<h2 id="badges">Badges</h2>
<p><a href="https://saucelabs.com/u/printj"><img src="https://saucelabs.com/browser-matrix/printj.svg" alt="Build Status" /></a></p>
<p><a href="https://travis-ci.org/SheetJS/printj"><img src="https://travis-ci.org/SheetJS/printj.svg?branch=master" alt="Build Status" /></a></p>
<p><a href="https://coveralls.io/r/SheetJS/printj?branch=master"><img src="http://img.shields.io/coveralls/SheetJS/printj/master.svg" alt="Coverage Status" /></a></p>
<p><a href="https://npmjs.org/package/printj"><img src="https://img.shields.io/npm/dt/printj.svg" alt="NPM Downloads" /></a></p>
<p><a href="https://david-dm.org/sheetjs/printj"><img src="https://david-dm.org/sheetjs/printj/status.svg" alt="Dependencies Status" /></a></p>
<p><a href="https://ghit.me/repo/sheetjs/printj"><img src="https://ghit.me/badge.svg?repo=sheetjs/printj" alt="ghit.me" /></a></p>
<p><a href="https://github.com/SheetJS/printj"><img src="https://ga-beacon.appspot.com/UA-36810333-1/SheetJS/printj?pixel" alt="Analytics" /></a></p>
<h1 id="printf-format-string-specification">printf format string specification</h1>
<p>The <code>printf</code> family of functions attempt to generate and output a string of characters from a series of arguments, following a user-supplied “format string” specification. The format string contains normal characters that are written to the output string as well as specifiers that describe which parameter to insert and how to render the parameter. This specification describes how a conformant implementation should process the format string and generate an output string. Any discrepancies between this document and the reference implementation are considered bugs in the implementation.</p>
<h3 id="original-c-interface">Original C Interface</h3>
<p>Every function in the <code>printf</code> family follows the same logic to generate strings but have different interfaces reflecting different input and output behaviors. Some functions have wide variants that use wide <code>wchar_t *</code> strings rather than normal C <code>char *</code>. The following variants are required by the POSIX spec:</p>
<table>
<thead>
<tr class="header">
<th>function</th>
<th>max length</th>
<th>output destination</th>
<th>vintage</th>
<th>wide ver</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>printf</code></td>
<td>unbounded</td>
<td>standard output</td>
<td>K&amp;R</td>
<td><code>wprintf</code></td>
</tr>
<tr class="even">
<td><code>fprintf</code></td>
<td>unbounded</td>
<td>stream (<code>FILE *</code>)</td>
<td>K&amp;R</td>
<td><code>fwprintf</code></td>
</tr>
<tr class="odd">
<td><code>sprintf</code></td>
<td>unbounded</td>
<td>string (<code>char *</code>)</td>
<td>K&amp;R</td>
<td><code>swprintf</code></td>
</tr>
<tr class="even">
<td><code>snprintf</code></td>
<td>parameter</td>
<td>string (<code>char *</code>)</td>
<td>C99</td>
<td></td>
</tr>
<tr class="odd">
<td><code>dprintf</code></td>
<td>unbounded</td>
<td>POSIX file descriptor</td>
<td>POSIX</td>
<td></td>
</tr>
</tbody>
</table>
<p>Each function has a dual function, whose name begins with <code>v</code>, that accepts the parameters as a <code>va_list</code> rather than formal parameters. In all cases, they return the number of characters written or a negative value to indicate error:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb6-1" title="1"><span class="dt">int</span>   sprintf(<span class="dt">char</span> *ostr, <span class="dt">const</span> <span class="dt">char</span> *fmt, ...);</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="dt">int</span>  vsprintf(<span class="dt">char</span> *ostr, <span class="dt">const</span> <span class="dt">char</span> *fmt, <span class="dt">va_list</span> arg_list);</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="dt">int</span>  swprintf(<span class="dt">wchar_t</span> *ostr, <span class="dt">const</span> <span class="dt">wchar_t</span> *fmt, ...);</a>
<a class="sourceLine" id="cb6-5" title="5"><span class="dt">int</span> vswprintf(<span class="dt">wchar_t</span> *ostr, <span class="dt">const</span> <span class="dt">wchar_t</span> *fmt, <span class="dt">va_list</span> arg_list);</a></code></pre></div>
<h3 id="js-and-c-strings">JS and C strings</h3>
<p>C “strings” are really just arrays of numbers. An external code page (such as ASCII) maps those numbers to characters. K&amp;R defines two types of strings: basic character set strings (<code>char *</code>) and extended character set strings (<code>wchar_t *</code>). In contrast, JS has a true string value type.</p>
<p>Unlike in C, JS strings do not treat the null character as an end-of-string marker. As a result, characters beyond the first null character will be used.</p>
<p>The JS equivalent of a C extended string would be an array of the individual character codes. The C basic string equivalent would involve specifying a code page and mapping back. The <code>codepage</code> JS library supports common codepages.</p>
<p>While capturing the essence of C strings, using arrays of character codes is not idiomatic JS. Few developers leverage this and the downsides far exceed the benefits of a more direct translation. The effect can be feigned, as shown in the <code>js2c</code> code sample at the end of the document.</p>
<h3 id="js-interface">JS Interface</h3>
<p>In the absence of a standard output or even a standard concept of a stream, the non-string outputs are irrelevant. Similarly there is no JS analogue of wide characters. While useful, lack of direct memory management obviates <code>snprintf</code>. This implementation exports the remaining functions, <code>sprintf</code> and <code>vsprintf</code>.</p>
<p>Instead of replicating the original C signature and <code>errno</code>, functions directly return the output string and throw Errors:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode typescript"><code class="sourceCode typescript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">function</span>  <span class="fu">sprintf</span>(fmt<span class="op">:</span><span class="dt">string</span><span class="op">,</span> <span class="op">...</span>args)<span class="op">:</span><span class="dt">string</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">function</span> <span class="fu">vsprintf</span>(fmt<span class="op">:</span><span class="dt">string</span><span class="op">,</span> args<span class="op">:</span><span class="bu">Array</span><span class="op">&lt;</span><span class="dt">any</span><span class="op">&gt;</span>)<span class="op">:</span><span class="dt">string</span><span class="op">;</span></a></code></pre></div>
<p>The C functions return the number of characters written to the string, which is directly accessible in JS via the <code>length</code> property. A direct replica of the various string functions are included at the end of the document.</p>
<h2 id="specifier-heritage-and-regular-expression">Specifier heritage and regular expression</h2>
<p>Note: The regular expressions follow perl <code>/x</code> style. Whitespace characters outside of character classes are ignored. <code>#</code> is a comment character and every character until the end of the line is ignored. To convert to a standard regex:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="va">regex_string</span>.<span class="at">replace</span>(<span class="ss">/#.</span><span class="sc">*$</span><span class="ss">/gm</span><span class="op">,</span><span class="st">&quot;&quot;</span>).<span class="at">replace</span>(<span class="ss">/</span><span class="sc">^\s*</span><span class="ss">/gm</span><span class="op">,</span><span class="st">&quot;&quot;</span>).<span class="at">replace</span>(<span class="ss">/</span><span class="sc">\s*\n</span><span class="ss">/gm</span><span class="op">,</span><span class="st">&quot;&quot;</span>)<span class="op">;</span></a></code></pre></div>
<p>Based on K&amp;R, conversions originally followed the format:</p>
<ul>
<li>required: leading <code>%</code></li>
<li>optional: <code>-</code> (POSIX refers to this as the “flags”)</li>
<li>optional: positive number or <code>*</code> (POSIX “width”)</li>
<li>optional: period followed by positive number or <code>*</code> (POSIX “precision”)</li>
<li>optional: an <code>h</code> or <code>l</code> to indicate size of data (POSIX “length”)</li>
<li>required: character describing output behavior (POSIX “conversion specifier”)</li>
</ul>
<p>This is captured by the regular expression:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode perl"><code class="sourceCode perl"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">/</span><span class="ot">%</span><span class="ch">(?:</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="ot">    </span><span class="ch">([</span><span class="bn">-</span><span class="ch">])?</span><span class="co">                             # flags (only minus sign)</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="ot">    </span><span class="ch">(</span><span class="bn">\d</span><span class="ch">+|</span><span class="ot">\*</span><span class="ch">)?</span><span class="co">                          # width</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="ot">    </span><span class="ch">(?:</span><span class="ot">\.</span><span class="ch">(</span><span class="bn">\d</span><span class="ch">+|</span><span class="ot">\*</span><span class="ch">))?</span><span class="co">                    # period + precision</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="ot">    </span><span class="ch">([</span><span class="bn">hl</span><span class="ch">])?</span><span class="co">                            # length</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="ot">    </span><span class="ch">([</span><span class="bn">dioxXucsfeEgGp%</span><span class="ch">])</span><span class="co">                # conversion specifier</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="ch">)</span><span class="kw">/x</span></a></code></pre></div>
<p>Various implementations of <code>printf</code> have added different functionality.</p>
<p>ANSI standards up through C99:</p>
<ul>
<li>more flags <code>"+"</code> <code>" "</code> <code>"0"</code> <code>"#"</code></li>
<li>more lengths <code>"L"</code> <code>"hh"</code> <code>"ll"</code> <code>"j"</code> <code>"z"</code> <code>"t"</code></li>
<li>more conversions <code>"F"</code> <code>"a"</code> <code>"A"</code> <code>"n"</code></li>
</ul>
<p>The POSIX specification of <code>printf</code> added:</p>
<ul>
<li>positional parameters to identify argument indices</li>
<li>more flags <code>"'"</code></li>
<li>more conversions <code>"C"</code> <code>"S"</code></li>
<li>clarifications regarding corner cases and “undefined behavior”</li>
</ul>
<p>BSD implementations added:</p>
<ul>
<li>more lengths <code>"q"</code></li>
<li>more conversions <code>"D"</code> <code>"U"</code> <code>"O"</code></li>
</ul>
<p>glibc (GNU) added:</p>
<ul>
<li>more lengths <code>"Z"</code></li>
<li>more conversions <code>"m"</code></li>
</ul>
<p>Windows C Runtime (CRT) added:</p>
<ul>
<li>more lengths <code>"I"</code> <code>"I32"</code> <code>"I64"</code> <code>"w"</code></li>
</ul>
<p>glibc and CRT both added <code>Z</code>. glibc uses <code>Z</code> for the length <code>size_t</code>. CRT uses <code>Z</code> as a conversion for length-prefixed strings. This implementation takes the former approach, handling <code>Z</code> in the same way as <code>z</code>.</p>
<p>BSD and IBM C library both added <code>D</code>. BSD uses <code>D</code> as a conversion, namely as an alias of <code>ld</code>. IBM uses <code>D</code> for the length for <code>_Decimal64</code>, a decimal floating point type, in accordance with ISO/IEC TR 24732. This implementation takes the former approach.</p>
<p>This implementation also adds new conversions:</p>
<ul>
<li><code>"b"</code> and <code>"B"</code> for binary (base-2) integer renderings</li>
<li><code>"y"</code> and <code>"Y"</code> for true/false and yes/no Boolean conversions</li>
<li><code>"J"</code> for JSON</li>
<li><code>"T"</code> and <code>"V"</code> for JS typeof and valueOf inspection</li>
</ul>
<p>Combining the various extensions yields the following regular expression:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode perl"><code class="sourceCode perl"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">/</span><span class="ot">%</span><span class="ch">(?:</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="ot">    %</span><span class="ch">|</span><span class="co">                                  # literal %% (flags etc prohibited)</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="ot">    </span><span class="ch">([</span><span class="bn">1-9</span><span class="ch">]</span><span class="bn">\d</span><span class="ch">*</span><span class="ot">\$</span><span class="ch">)?</span><span class="co">                       # positional parameter</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="ot">    </span><span class="ch">([</span><span class="bn">-+ 0\x23\x27</span><span class="ch">]*)?</span><span class="co">                  # flags</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="ot">    </span><span class="ch">([</span><span class="bn">1-9</span><span class="ch">]</span><span class="bn">\d</span><span class="ch">*|</span><span class="ot">\*</span><span class="ch">(?:[</span><span class="bn">1-9</span><span class="ch">]</span><span class="bn">\d</span><span class="ch">*</span><span class="ot">\$</span><span class="ch">)?)?</span><span class="co">       # width</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="ot">    </span><span class="ch">(?:</span><span class="ot">\.</span><span class="ch">(</span><span class="bn">\d</span><span class="ch">+|</span><span class="ot">\*</span><span class="ch">(?:[</span><span class="bn">1-9</span><span class="ch">]</span><span class="bn">\d</span><span class="ch">*</span><span class="ot">\$</span><span class="ch">)?))?</span><span class="co">      # precision</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="ot">    </span><span class="ch">(</span><span class="ot">hh</span><span class="ch">?|</span><span class="ot">ll</span><span class="ch">?|[</span><span class="bn">LzjtqZIw</span><span class="ch">])?</span><span class="co">               # length</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="ot">    </span><span class="ch">([</span><span class="bn">diouxXfFeEgGaAcCsSpnDUOmbByYJVT</span><span class="ch">])</span><span class="ot"> # conversion specifier</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="ch">)</span><span class="kw">/x</span></a></code></pre></div>
<p>This implementation explicitly does not support certain non-standard extensions:</p>
<ul>
<li>AltiVec vector length extensions (<code>v</code> with <code>h</code>/<code>l</code>/<code>ll</code>):</li>
<li>CRT fixed width lengths <code>I32</code> and <code>I64</code></li>
</ul>
<h2 id="conversion-specifier-quick-reference-table">Conversion Specifier Quick Reference Table</h2>
<table>
<thead>
<tr class="header">
<th>C</th>
<th style="text-align: center;">Type</th>
<th>Summary</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>a</code></td>
<td style="text-align: center;">floating</td>
<td>base-2 exp form w/ hex mantissa and dec exponent, lowercase</td>
</tr>
<tr class="even">
<td><code>A</code></td>
<td style="text-align: center;">floating</td>
<td>base-2 exp form w/ hex mantissa and dec exponent, uppercase</td>
</tr>
<tr class="odd">
<td><code>b</code></td>
<td style="text-align: center;">extended</td>
<td>cast to C <code>unsigned int</code>, standard form binary</td>
</tr>
<tr class="even">
<td><code>B</code></td>
<td style="text-align: center;">extended</td>
<td>cast to C <code>unsigned long</code>, standard form binary</td>
</tr>
<tr class="odd">
<td><code>c</code></td>
<td style="text-align: center;">text</td>
<td>print <code>latin-1</code> char from number OR first char of string</td>
</tr>
<tr class="even">
<td><code>C</code></td>
<td style="text-align: center;">text</td>
<td>print <code>UCS-2</code> char from number OR first char of string</td>
</tr>
<tr class="odd">
<td><code>d</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>int</code>, standard form decimal</td>
</tr>
<tr class="even">
<td><code>D</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>long</code>, standard form decimal</td>
</tr>
<tr class="odd">
<td><code>e</code></td>
<td style="text-align: center;">floating</td>
<td>base-10 exp form w/dec mantissa and dec exponent, lowercase</td>
</tr>
<tr class="even">
<td><code>E</code></td>
<td style="text-align: center;">floating</td>
<td>base-10 exp form w/dec mantissa and dec exponent, uppercase</td>
</tr>
<tr class="odd">
<td><code>f</code></td>
<td style="text-align: center;">floating</td>
<td>base-10 decimal form, lowercase extended values</td>
</tr>
<tr class="even">
<td><code>F</code></td>
<td style="text-align: center;">floating</td>
<td>base-10 decimal form, uppercase extended values</td>
</tr>
<tr class="odd">
<td><code>g</code></td>
<td style="text-align: center;">floating</td>
<td>print using <code>e</code> or <code>f</code> conversion based on value/precision</td>
</tr>
<tr class="even">
<td><code>G</code></td>
<td style="text-align: center;">floating</td>
<td>print using <code>E</code> or <code>F</code> conversion based on value/precision</td>
</tr>
<tr class="odd">
<td><code>i</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>int</code>, standard form decimal (alias of <code>d</code>)</td>
</tr>
<tr class="even">
<td><code>J</code></td>
<td style="text-align: center;">extended</td>
<td>prints objects using JSON or <code>util.inspect</code></td>
</tr>
<tr class="odd">
<td><code>m</code></td>
<td style="text-align: center;">misc</td>
<td>prints info about Error objects (JS equivalent of <code>errno</code>)</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td style="text-align: center;">misc</td>
<td>do not print! stores number of chars written to arg <code>.len</code></td>
</tr>
<tr class="odd">
<td><code>o</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned int</code>, standard form octal</td>
</tr>
<tr class="even">
<td><code>O</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned long</code>, standard form octal</td>
</tr>
<tr class="odd">
<td><code>p</code></td>
<td style="text-align: center;">misc</td>
<td>print <code>"l"</code> field of object (fake pointer)</td>
</tr>
<tr class="even">
<td><code>s</code></td>
<td style="text-align: center;">text</td>
<td>print string argument</td>
</tr>
<tr class="odd">
<td><code>S</code></td>
<td style="text-align: center;">text</td>
<td>print string argument (alias of <code>"s"</code>)</td>
</tr>
<tr class="even">
<td><code>T</code></td>
<td style="text-align: center;">extended</td>
<td>print type information (<code>typeof</code> or <code>Object toString</code>)</td>
</tr>
<tr class="odd">
<td><code>u</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned int</code>, standard form decimal</td>
</tr>
<tr class="even">
<td><code>U</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned long</code>, standard form decimal</td>
</tr>
<tr class="odd">
<td><code>V</code></td>
<td style="text-align: center;">extended</td>
<td>print primitive value (<code>valueOf</code>)</td>
</tr>
<tr class="even">
<td><code>x</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned int</code>, standard form hex, lowercase</td>
</tr>
<tr class="odd">
<td><code>X</code></td>
<td style="text-align: center;">integral</td>
<td>cast to C <code>unsigned long</code>, standard form hex, uppercase</td>
</tr>
<tr class="even">
<td><code>y</code></td>
<td style="text-align: center;">extended</td>
<td>prints <code>true</code>/<code>false</code> or <code>yes</code>/<code>no</code> based on Boolean value</td>
</tr>
<tr class="odd">
<td><code>Y</code></td>
<td style="text-align: center;">extended</td>
<td>prints <code>TRUE</code>/<code>FALSE</code> or <code>YES</code>/<code>NO</code> based on Boolean value</td>
</tr>
<tr class="even">
<td><code>%</code></td>
<td style="text-align: center;">misc</td>
<td>print the literal <code>%</code> character</td>
</tr>
</tbody>
</table>
<h2 id="parameter-selection">Parameter Selection</h2>
<p>The default behavior is to consume arguments in order:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb11-1" title="1">printf(<span class="st">&quot;Count to 3: %d %d %d&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>); <span class="co">// Count to 3: 1 2 3</span></a></code></pre></div>
<p>POSIX <code>printf</code> permits explicit argument selection, bypassing the standard behavior of using the arguments in order. To select the <code>n</code>-th argument, use <code>n$</code> immediately after the <code>%</code> token to select an argument for the conversion:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb12-1" title="1">printf(<span class="st">&quot;%d %d %d&quot;</span>,       <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>);        <span class="co">// 1 2 3 (implicit order 1, 2, 3 )</span></a>
<a class="sourceLine" id="cb12-2" title="2">printf(<span class="st">&quot;%1$s %2$s %3$s&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>);  <span class="co">// a b c (explicit order 1, 2, 3 )</span></a>
<a class="sourceLine" id="cb12-3" title="3">printf(<span class="st">&quot;%1$s %3$s %2$s&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>);  <span class="co">// a c b (explicit order 1, 3, 2 )</span></a></code></pre></div>
<p>The POSIX standard asserts that mixing positional and non-positional conversions is undefined behavior. This implementation handles mixing by tracking the index for non-positional conversions:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb13-1" title="1">printf(<span class="st">&quot;%s %4$s %s %5$s %s&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>); <span class="co">// a d b e c</span></a></code></pre></div>
<p>The POSIX standard requires that if an argument is used in the format, every preceding argument must be used. This implementation relaxes that requirement:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb14-1" title="1">printf(<span class="st">&quot;%3$s&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>); <span class="co">// c (technically invalid since &quot;a&quot;/&quot;b&quot; unused)</span></a></code></pre></div>
<h2 id="dynamic-specifiers">Dynamic Specifiers</h2>
<p>The width and precision specifiers may include the dynamic specifier <code>*</code> which instructs the engine to read the next argument (assumed to be an integer). Just as with the positional parameter, <code>idx$</code> immediately after the <code>*</code> token selects the numeric argument.</p>
<p>For example:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb15-1" title="1">printf(<span class="st">&quot;|%5s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);               <span class="co">// |sheetjs|    (width = 5)</span></a>
<a class="sourceLine" id="cb15-2" title="2">printf(<span class="st">&quot;|%*s|&quot;</span>, <span class="dv">5</span>, <span class="st">&quot;sheetjs&quot;</span>);            <span class="co">// |sheetjs|    (width first argument)</span></a>
<a class="sourceLine" id="cb15-3" title="3">printf(<span class="st">&quot;|%2$*1$s|&quot;</span>, <span class="dv">5</span>, <span class="st">&quot;sheetjs&quot;</span>, <span class="dv">10</span>);    <span class="co">// |sheetjs|    (width is argument #1)</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5">printf(<span class="st">&quot;|%10s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);              <span class="co">// |   sheetjs| (width = 10)</span></a>
<a class="sourceLine" id="cb15-6" title="6">printf(<span class="st">&quot;|%2$*3$s|&quot;</span>, <span class="dv">5</span>, <span class="st">&quot;sheetjs&quot;</span>, <span class="dv">10</span>);    <span class="co">// |   sheetjs| (width is argument #3)</span></a></code></pre></div>
<p>Arguments are generally consumed in order as presented in the format string:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb16-1" title="1">printf(<span class="st">&quot;|%s|&quot;</span>, val);</a>
<a class="sourceLine" id="cb16-2" title="2">printf(<span class="st">&quot;|%*s|&quot;</span>, width, val);</a>
<a class="sourceLine" id="cb16-3" title="3">printf(<span class="st">&quot;|%.*s|&quot;</span>, prec, val);</a>
<a class="sourceLine" id="cb16-4" title="4">printf(<span class="st">&quot;|%*.*s|&quot;</span>, width, prec, val);</a>
<a class="sourceLine" id="cb16-5" title="5">printf(<span class="st">&quot;|%0*.*d|&quot;</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);  <span class="co">// |  01| width=4 prec=2 value=1</span></a></code></pre></div>
<p>Positional arguments can be applied to width and precision:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb17-1" title="1">printf(<span class="st">&quot;|%*.*d|&quot;</span>, width, prec, val);</a>
<a class="sourceLine" id="cb17-2" title="2">printf(<span class="st">&quot;|%2$0*3$.*1$d|&quot;</span>, prec, val, width);</a>
<a class="sourceLine" id="cb17-3" title="3">printf(<span class="st">&quot;|%0*.*d|&quot;</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);        <span class="co">// |  01| width=4 prec=2 value=1 flags=&#39;0&#39;</span></a>
<a class="sourceLine" id="cb17-4" title="4">printf(<span class="st">&quot;|%1$0*3$.*2$d|&quot;</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>);  <span class="co">// |  01| width=4 prec=2 value=1 flags=&#39;0&#39;</span></a></code></pre></div>
<p>A negative width is interpreted as the <code>-</code> flag with a positive width:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb18-1" title="1">printf(<span class="st">&quot;|%*.*d|&quot;</span>,   <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);        <span class="co">// |  01| width=4 prec=2 value=1 flags=&#39;&#39;</span></a>
<a class="sourceLine" id="cb18-2" title="2">printf(<span class="st">&quot;|%-*.*d|&quot;</span>,  <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);        <span class="co">// |01  | width=4 prec=2 value=1 flags=&#39;-&#39;</span></a>
<a class="sourceLine" id="cb18-3" title="3">printf(<span class="st">&quot;|%*.*d|&quot;</span>,  -<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);        <span class="co">// |01  | width=4 prec=2 value=1 flags=&#39;-&#39;</span></a>
<a class="sourceLine" id="cb18-4" title="4">printf(<span class="st">&quot;|%-*.*d|&quot;</span>, -<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>);        <span class="co">// |01  | width=4 prec=2 value=1 flags=&#39;-&#39;</span></a></code></pre></div>
<p>A negative precision is discarded:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb19-1" title="1">printf(<span class="st">&quot;|%*s|&quot;</span>, <span class="dv">4</span>, <span class="st">&quot;sheetjs&quot;</span>);       <span class="co">// |sheetjs|  width=4</span></a>
<a class="sourceLine" id="cb19-2" title="2">printf(<span class="st">&quot;|%*.*s|&quot;</span>, <span class="dv">4</span>,  <span class="dv">3</span>, <span class="st">&quot;sheetjs&quot;</span>); <span class="co">// | she|     width=4 prec=3</span></a>
<a class="sourceLine" id="cb19-3" title="3">printf(<span class="st">&quot;|%*.*s|&quot;</span>, <span class="dv">4</span>,  <span class="dv">2</span>, <span class="st">&quot;sheetjs&quot;</span>); <span class="co">// |  sh|     width=4 prec=2</span></a>
<a class="sourceLine" id="cb19-4" title="4">printf(<span class="st">&quot;|%*.*s|&quot;</span>, <span class="dv">4</span>,  <span class="dv">1</span>, <span class="st">&quot;sheetjs&quot;</span>); <span class="co">// |   s|     width=4 prec=1</span></a>
<a class="sourceLine" id="cb19-5" title="5">printf(<span class="st">&quot;|%*.*s|&quot;</span>, <span class="dv">4</span>,  <span class="dv">0</span>, <span class="st">&quot;sheetjs&quot;</span>); <span class="co">// |    |     width=4 prec=0</span></a>
<a class="sourceLine" id="cb19-6" title="6">printf(<span class="st">&quot;|%*.*s|&quot;</span>, <span class="dv">4</span>, -<span class="dv">1</span>, <span class="st">&quot;sheetjs&quot;</span>); <span class="co">// |sheetjs|  width=4 (prec ignored)</span></a></code></pre></div>
<h1 id="c-data-model">C Data Model</h1>
<p>JS has one numeric type <code>Number</code> which represents an IEEE754 double-precision (64-bit) floating point number. C has a multitude of numeric types, including floating point as well as integer types. The sizes of those data types are implementation-dependent. A “C data model” specifies the sizes of the core C data types.</p>
<h3 id="integer-types">Integer Types</h3>
<p>POSIX <code>printf</code> specification references 8 integer types in integer conversions:</p>
<table>
<thead>
<tr class="header">
<th>C data type</th>
<th style="text-align: right;">fmt</th>
<th>unsigned type</th>
<th style="text-align: right;">fmt</th>
<th>signed type</th>
<th style="text-align: right;">fmt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>char</code></td>
<td style="text-align: right;"></td>
<td><code>unsigned char</code></td>
<td style="text-align: right;"><code>hhu</code></td>
<td><code>signed char</code></td>
<td style="text-align: right;"><code>hhd</code></td>
</tr>
<tr class="even">
<td><code>short</code></td>
<td style="text-align: right;"><code>hd</code></td>
<td><code>unsigned short</code></td>
<td style="text-align: right;"><code>hu</code></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code>int</code></td>
<td style="text-align: right;"><code>d</code></td>
<td><code>unsigned int</code></td>
<td style="text-align: right;"><code>u</code></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td><code>long</code></td>
<td style="text-align: right;"><code>ld</code></td>
<td><code>unsigned long</code></td>
<td style="text-align: right;"><code>lu</code></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td><code>long long</code></td>
<td style="text-align: right;"><code>lld</code></td>
<td><code>unsigned long long</code></td>
<td style="text-align: right;"><code>llu</code></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td><code>size_t</code></td>
<td style="text-align: right;"><code>zu</code></td>
<td></td>
<td style="text-align: right;"></td>
<td><code>ssize_t</code></td>
<td style="text-align: right;"><code>zd</code></td>
</tr>
<tr class="odd">
<td><code>intmax_t</code></td>
<td style="text-align: right;"><code>jd</code></td>
<td><code>uintmax_t</code></td>
<td style="text-align: right;"><code>ju</code></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td><code>ptrdiff_t</code></td>
<td style="text-align: right;"><code>td</code></td>
<td></td>
<td style="text-align: right;"></td>
<td></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>C99 does not officially define a signed <code>size_t</code> or unsigned <code>ptrdiff_t</code> type. POSIX does define <code>ssize_t</code> but no equivalent <code>uptrdiff_t</code>.</p>
<p>BSD additionally recognizes the types <code>quad_t</code> and <code>u_quad_t</code>, which this implementation treats as <code>long long int</code> and <code>unsigned long long int</code>.</p>
<h3 id="character-and-string-types">Character and String Types</h3>
<p>Two integer types are used in character and string conversions:</p>
<table>
<thead>
<tr class="header">
<th>type</th>
<th style="text-align: right;">fmt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>wchar_t</code></td>
<td style="text-align: right;"><code>ls</code></td>
</tr>
<tr class="even">
<td><code>wint_t</code></td>
<td style="text-align: right;"><code>lc</code></td>
</tr>
</tbody>
</table>
<p>Both wide types <code>wchar_t</code> and <code>wint_t</code> can be signed or unsigned according to C99. Both types are used only in character and string conversions. Based on K&amp;R “printable characters are always positive”, the types are assumed unsigned.</p>
<h3 id="floating-point-number-types">Floating Point Number Types</h3>
<p>K&amp;R recognizes 3 floating point types. C99 later tied it to IEC 60559:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">C data type</th>
<th style="text-align: left;">precision</th>
<th style="text-align: center;">total bits</th>
<th style="text-align: center;">exponent</th>
<th style="text-align: center;">mantissa</th>
<th style="text-align: right;">fmt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>float</code></td>
<td style="text-align: left;">single</td>
<td style="text-align: center;"><code>32</code></td>
<td style="text-align: center;"><code>8</code></td>
<td style="text-align: center;"><code>23</code></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>double</code></td>
<td style="text-align: left;">double</td>
<td style="text-align: center;"><code>64</code></td>
<td style="text-align: center;"><code>11</code></td>
<td style="text-align: center;"><code>52</code></td>
<td style="text-align: right;"><code>f</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>long double</code></td>
<td style="text-align: left;">extended</td>
<td style="text-align: center;"><code>80</code></td>
<td style="text-align: center;"><code>15</code></td>
<td style="text-align: center;"><code>64</code></td>
<td style="text-align: right;"><code>Lf</code></td>
</tr>
</tbody>
</table>
<h2 id="implementation">Implementation</h2>
<p>Numerous “C data models”, specifying the bit/byte sizes of the various types, have been and continue to be used. For example, OSX and other modern 64-bit UNIX flavors use the “LP64” C data model. 64-bit Windows currently uses the “LLP64” model. 32-bit systems generally use the “ILP32” model. The 8-bit byte sizes for the various types under the various models are defined in ctypes.json in the <code>Models</code> object as per the following table:</p>
<table>
<thead>
<tr class="header">
<th>type</th>
<th>ctypes.json</th>
<th style="text-align: right;">LP64</th>
<th style="text-align: right;">ILP32</th>
<th style="text-align: right;">LLP64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>char</code></td>
<td><code>char</code></td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td><code>short</code></td>
<td><code>short</code></td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td><code>int</code></td>
<td><code>int</code></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td><code>long</code></td>
<td><code>long</code></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td><code>long long</code></td>
<td><code>longlong</code></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td><code>wchar_t</code></td>
<td><code>wchar_t</code></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td><code>wint_t</code></td>
<td><code>wint_t</code></td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td><code>size_t</code></td>
<td><code>size_t</code></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td><code>intmax_t</code></td>
<td><code>intmax_t</code></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td><code>ptrdiff_t</code></td>
<td><code>ptrdiff_t</code></td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">8</td>
</tr>
</tbody>
</table>
<p>By default the source assumes the LP64 data model. Other data models are supported in the source tree, controlled by the JSFLAGS variable in the build process. Set the <code>JS_MODEL</code> variable to the desired index as specified in the <code>ModelNames</code> array in <code>bits/ctype.json</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" title="1">$ <span class="op">&lt;</span><span class="ex">bits/ctypes.json</span> jq -r <span class="st">&#39;.ModelNames|.[]&#39;</span>  <span class="co"># LP64 ILP32 LLP64</span></a>
<a class="sourceLine" id="cb20-2" title="2">$ <span class="va">JSFLAGS=</span>-DJS_MODEL=<span class="ex">0</span> make                  <span class="co"># LP64</span></a>
<a class="sourceLine" id="cb20-3" title="3">$ <span class="va">JSFLAGS=</span>-DJS_MODEL=<span class="ex">1</span> make                  <span class="co"># ILP32</span></a>
<a class="sourceLine" id="cb20-4" title="4">$ <span class="va">JSFLAGS=</span>-DJS_MODEL=<span class="ex">2</span> make                  <span class="co"># LLP64</span></a></code></pre></div>
<p>To create a custom model, add the spec to <code>bits/ctypes.json</code> by appending the model name to the end of the <code>ModelNames</code> array and adding an entry to the <code>Models</code> object. The current models are defined as follows:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb21-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb21-2" title="2">  <span class="dt">&quot;ModelNames&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;LP64&quot;</span><span class="ot">,</span> <span class="st">&quot;ILP32&quot;</span><span class="ot">,</span> <span class="st">&quot;LLP64&quot;</span><span class="ot">]</span><span class="fu">,</span></a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="dt">&quot;Models&quot;</span><span class="fu">:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb21-4" title="4">    <span class="dt">&quot;LP64&quot;</span><span class="fu">:</span>  <span class="fu">{</span> <span class="dt">&quot;char&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">&quot;short&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">&quot;int&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;long&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;longlong&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;wint_t&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;wchar_t&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;size_t&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;intmax_t&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;ptrdiff_t&quot;</span><span class="fu">:</span><span class="dv">8</span> <span class="fu">},</span></a>
<a class="sourceLine" id="cb21-5" title="5">    <span class="dt">&quot;ILP32&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;char&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">&quot;short&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">&quot;int&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;long&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;longlong&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;wint_t&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;wchar_t&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;size_t&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;intmax_t&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;ptrdiff_t&quot;</span><span class="fu">:</span><span class="dv">4</span> <span class="fu">},</span></a>
<a class="sourceLine" id="cb21-6" title="6">    <span class="dt">&quot;LLP64&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;char&quot;</span><span class="fu">:</span><span class="dv">1</span><span class="fu">,</span> <span class="dt">&quot;short&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">&quot;int&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;long&quot;</span><span class="fu">:</span><span class="dv">4</span><span class="fu">,</span> <span class="dt">&quot;longlong&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;wint_t&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">&quot;wchar_t&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span> <span class="dt">&quot;size_t&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;intmax_t&quot;</span><span class="fu">:</span><span class="dv">8</span><span class="fu">,</span> <span class="dt">&quot;ptrdiff_t&quot;</span><span class="fu">:</span><span class="dv">8</span> <span class="fu">}</span></a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="fu">}</span></a></code></pre></div>
<h1 id="integer-conversions">Integer Conversions</h1>
<p>This section covers the conversions <code>diouxXDUO</code>. The base-2 conversions <code>bB</code> are an extension and are discussed at the end, but the same basic rules apply.</p>
<p>JS has one Number type (representing an IEEE754 8-byte floating point number) that is capable of representing a 32-bit integer. It cannot represent the full range of 64-bit integers exactly. Care is taken to avoid operations that may inadvertently result in a conversion to a smaller integral type.</p>
<h2 id="restricting-integer-values">Restricting Integer Values</h2>
<p>JS Bitwise operations convert numbers to 32-bit integers before performing operations. With the exception of the unsigned right shift operator <code>&gt;&gt;&gt;</code>, all operations act on signed integers. For example:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="va">Math</span>.<span class="at">pow</span>(<span class="dv">2</span><span class="op">,</span><span class="dv">31</span>) <span class="op">|</span> <span class="dv">0</span><span class="op">;</span>        <span class="co">// -2147483648 == -Math.pow(2,31)</span></a>
<a class="sourceLine" id="cb22-2" title="2">(<span class="va">Math</span>.<span class="at">pow</span>(<span class="dv">2</span><span class="op">,</span><span class="dv">32</span>)<span class="op">-</span><span class="dv">2</span>) <span class="op">^</span> <span class="dv">0</span><span class="op">;</span>    <span class="co">// -2</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="dv">-1</span> <span class="op">&gt;&gt;&gt;</span> <span class="dv">0</span>                   <span class="co">// 4294967295 == Math.pow(2,32) - 1</span></a></code></pre></div>
<p>JS Number can exactly represent every integer in the range <code>-2^53 .. 2^53</code>. For lengths exceeding 32 bits, <code>Math.round</code> is appropriate.</p>
<table>
<thead>
<tr class="header">
<th>bits</th>
<th>unsigned</th>
<th>signed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>8</td>
<td><code>V &amp; 0xFF</code></td>
<td><code>V &amp;= 0xFF; if(V &gt; 0x7F) V-= 0x100</code></td>
</tr>
<tr class="even">
<td>16</td>
<td><code>V &amp; 0xFFFF</code></td>
<td><code>V &amp;= 0xFFFF; if(V &gt; 0x7FFF) V-= 0x10000</code></td>
</tr>
<tr class="odd">
<td>32</td>
<td><code>V &gt;&gt;&gt; 0</code></td>
<td><code>V | 0</code></td>
</tr>
<tr class="even">
<td>64</td>
<td><code>Math.abs(Math.round(V))</code></td>
<td><code>Math.round(V)</code></td>
</tr>
</tbody>
</table>
<h2 id="length-specifiers-for-integer-conversions">Length Specifiers for Integer Conversions</h2>
<p>When a length specifier implies a certain size (such as <code>hh</code> for a single-byte integer), the number will be converted before rendering strings. For example:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb23-1" title="1">printf(<span class="st">&quot;%1$02hhx %1$02hx %1$02lx %1$02llx&quot;</span>, <span class="dv">256</span>);       <span class="co">// |00 100 100 100|</span></a>
<a class="sourceLine" id="cb23-2" title="2">printf(<span class="st">&quot;%1$02hhx %1$02hx %1$02lx %1$02llx&quot;</span>, <span class="dv">4096</span>);      <span class="co">// |00 1000 1000 1000|</span></a>
<a class="sourceLine" id="cb23-3" title="3">printf(<span class="st">&quot;%1$02hhx %1$02hx %1$02lx %1$02llx&quot;</span>, <span class="dv">65536</span>);     <span class="co">// |00 00 10000 10000|</span></a></code></pre></div>
<p>Values are restricted by first limiting the result to a specified number of bytes (appropriate bit-and) and then adding or subtracting to ensure the value is signed or unsigned according to the conversion specifier. If a length is specified, it overrides the implied length of the conversion. The following table describes the behavior of this implementation:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">implied C type</th>
<th style="text-align: left;">ctypes.json</th>
<th style="text-align: center;">length</th>
<th style="text-align: left;">conv default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>int</code> or <code>unsigned int</code></td>
<td style="text-align: left;"><code>int</code></td>
<td style="text-align: center;">(none)</td>
<td style="text-align: left;">d i o u x X</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>char</code> or <code>unsigned char</code></td>
<td style="text-align: left;"><code>char</code></td>
<td style="text-align: center;">hh</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>short</code> or <code>unsigned short</code></td>
<td style="text-align: left;"><code>short</code></td>
<td style="text-align: center;">h</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>long</code> or <code>unsigned long</code></td>
<td style="text-align: left;"><code>long</code></td>
<td style="text-align: center;">l</td>
<td style="text-align: left;">D U O</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>long long</code> or <code>unsigned long long</code></td>
<td style="text-align: left;"><code>longlong</code></td>
<td style="text-align: center;">L ll q</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>intmax_t</code> or <code>uintmax_t</code></td>
<td style="text-align: left;"><code>intmax_t</code></td>
<td style="text-align: center;">j</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>size_t</code> or <code>ssize_t</code></td>
<td style="text-align: left;"><code>size_t</code></td>
<td style="text-align: center;">z Z</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ptrdiff_t</code> or unsigned variant</td>
<td style="text-align: left;"><code>ptrdiff_t</code></td>
<td style="text-align: center;">t</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h2 id="rendering-unsigned-integers-in-base-10-u-and-u-conversions">Rendering Unsigned Integers in Base 10 (“u” and “U” conversions)</h2>
<p><code>num.toString(10)</code> produces the correct result for exact integers.</p>
<p><code>"u"</code> conversion restricts values to <code>int</code>; <code>"U"</code> restricts to <code>long</code>.</p>
<h2 id="rendering-unsigned-integers-in-base-8-o-and-o-conversions">Rendering Unsigned Integers in Base 8 (“o” and “O” conversions)</h2>
<p>Even though <code>num.toString(8)</code> is implementation-dependent, all browser implementations use standard form for integers in the exact range.</p>
<p>The alternate form (<code>#</code>) prints a <code>"0"</code> prefix.</p>
<p><code>"o"</code> conversion restricts values to <code>int</code>; <code>"O"</code> restricts to <code>long</code>.</p>
<h2 id="rendering-unsigned-integers-in-base-16-x-and-x-conversions">Rendering Unsigned Integers in Base 16 (“x” and “X” conversions)</h2>
<p>Even though <code>num.toString(16)</code> is implementation-dependent, all browser implementations use standard form for integers in the exact range.</p>
<p>The alternate form (<code>#</code>) prints a <code>"0x"</code> or <code>"0X"</code> prefix.</p>
<p>Unlike <code>"U" "O" "D"</code>, <code>"X"</code> conversion uses <code>A-F</code> instead of <code>a-f</code> in hex.</p>
<h2 id="rendering-signed-integers-in-base-10-d-i-and-d-conversions">Rendering Signed Integers in Base 10 (“d” “i” and “D” conversions)</h2>
<p><code>num.toString(10)</code> produces the correct result for exact integers. The flags <code>" +"</code> control prefixes for positive integers.</p>
<p><code>"di"</code> conversions restrict values to <code>int</code>; <code>"D"</code> restricts to <code>long</code>.</p>
<h1 id="floating-point-conversions">Floating Point Conversions</h1>
<p>This section covers the conversions <code>fFeEgGaA</code>.</p>
<p>Due to C variadic argument promotion rules, <code>float</code> types are always promoted to <code>double</code>. None of the conversions or length specifiers signal that an argument is to be interpreted as a <code>float</code>. There is no JS canonical representation of an extended floating point number, so JS <code>Number</code> suffices.</p>
<h2 id="infinity-nan-and-negative-zero">Infinity, NaN, and Negative Zero</h2>
<p>JS recognizes a few special IEEE754 values, as described in the following table:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">JS value</th>
<th style="text-align: left;">JS Expression</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>Infinity</code></td>
<td style="text-align: left;"><code>1./0.</code></td>
<td style="text-align: left;">Positive limiting value <code>lim{x-&gt;0+} 1/x</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>-Infinity</code></td>
<td style="text-align: left;"><code>-1./0.</code></td>
<td style="text-align: left;">Negative limiting value <code>lim{x-&gt;0+} -1/x</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>NaN</code></td>
<td style="text-align: left;"><code>0./0.</code></td>
<td style="text-align: left;">Placeholder for “not-a-number” e.g. <code>0./0.</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>-0.</code></td>
<td style="text-align: left;"><code>-1/Infinity</code></td>
<td style="text-align: left;">Negative limiting value <code>lim{x-&gt;0-} x</code></td>
</tr>
</tbody>
</table>
<p>JS <code>Number</code> methods render different strings from the POSIX spec:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">JS value</th>
<th style="text-align: left;">POSIX string</th>
<th style="text-align: right;">JS string</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>Infinity</code></td>
<td style="text-align: left;"><code>"inf"  "INF"</code> or <code>"infinity"  "INFINITY"</code></td>
<td style="text-align: right;"><code>"Infinity"</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>-Infinity</code></td>
<td style="text-align: left;"><code>"-inf" "-INF"</code> or <code>"-infinity" "-INFINITY"</code></td>
<td style="text-align: right;"><code>"-Infinity"</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>NaN</code></td>
<td style="text-align: left;"><code>"[-]nan" "[-]NAN"</code> w/opt parenthesized chars</td>
<td style="text-align: right;"><code>"NaN"</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>-0.</code></td>
<td style="text-align: left;">uses negative sign (e.g. <code>"-0"</code> under <code>"%f"</code>)</td>
<td style="text-align: right;">same as <code>+0.</code></td>
</tr>
</tbody>
</table>
<p>This implementation performs the required adjustments.</p>
<h2 id="exponential-form-e-and-e-conversions">Exponential Form (“e” and “E” conversions)</h2>
<p>Aside from the special cases discussed above, JS <code>num.toExponential(prec)</code> differs from POSIX <code>printf("%1$.*2$e", num, prec)</code> in the exponent field: JS writes exponents with the fewest digits (POSIX requires 2+ digits). This is easily fixed by inspecting the output string and inserting a “0” when needed.</p>
<p>The optional <code>#</code> flag forces the decimal point to appear when precision is 0. This is also easily corrected by adding a decimal point just before the “e”.</p>
<h2 id="standard-form-f-and-f-conversions">Standard Form (“f” and “F” conversions)</h2>
<p>The POSIX spec only requires that the number of digits after the decimal point is equal to the precision. It does not specify how many digits appear before the decimal point, nor does it specify how to handle numbers that cannot be exactly represented.</p>
<p>For values less than <code>1e21</code> the JS <code>num.toFixed(n)</code> generally matches <code>%f</code> with the specified precision. However, for larger values <code>toFixed</code> defaults to the exponential form.</p>
<h2 id="value-dependent-form-g-and-g-conversions">Value-dependent Form (“g” and “G” conversions)</h2>
<p>The final form (exponential or standard) is determined based on the value. The threshold is different from the JS <code>toString</code> / <code>toPrecision</code> thresholds and depends on the specified precision as well as the base-10 exponent:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Value</th>
<th style="text-align: left;"><code>"%.3g"</code></th>
<th style="text-align: left;"><code>toPrecision(3)</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1.2345e-4</td>
<td style="text-align: left;"><code>0.000123</code></td>
<td style="text-align: left;"><code>0.000123</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">1.2345e-5</td>
<td style="text-align: left;"><code>1.23e-05</code></td>
<td style="text-align: left;"><code>0.0000123</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.2345e-6</td>
<td style="text-align: left;"><code>1.23e-06</code></td>
<td style="text-align: left;"><code>0.00000123</code></td>
</tr>
<tr class="even">
<td style="text-align: right;">1.2345e-7</td>
<td style="text-align: left;"><code>1.23e-07</code></td>
<td style="text-align: left;"><code>1.23e-7</code></td>
</tr>
</tbody>
</table>
<p>According to JS spec, <code>toPrecision</code> uses standard form when <code>precision &gt; E</code> and <code>E &gt;= -6</code>. For printf standard form is used when <code>precision &gt; E</code> and <code>E &gt;= -4</code>.</p>
<h2 id="hex-mantissa-decimal-binary-exponent-form-a-and-a-conversions">Hex-Mantissa Decimal-Binary-Exponent Form (“a” and “A” conversions)</h2>
<p>A general exponential form involves 3 parameters: radix of the mantissa, base of the exponent expression, and radix of the exponent expression. The standard exponential form uses decimal for all three parts. For base 16, there are quite a few reasonable combinations. Consider the value <code>1.234567e-80</code>:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Mant</th>
<th style="text-align: center;">Exp Base</th>
<th style="text-align: left;">Radix-10 (sigil <code>";"</code>)</th>
<th style="text-align: left;">Radix-16 (sigil <code>";"</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">10</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;"><code>1.234567;-80</code></td>
<td style="text-align: left;"><code>1.234567;-50</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: center;">10</td>
<td style="text-align: left;"><code>1.3c0c9539b8887;-80</code></td>
<td style="text-align: left;"><code>1.3c0c9539b8887;-50</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">16</td>
<td style="text-align: left;"><code>5.daf8c8f5f4104;-67</code></td>
<td style="text-align: left;"><code>5.daf8c8f5f4104;-43</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">16</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;"><code>1.76be323d7d041;-133</code></td>
<td style="text-align: left;"><code>1.76be323d7d041;-85</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">16</td>
<td style="text-align: center;">2</td>
<td style="text-align: left;"><code>1.76be323d7d041;-266</code></td>
<td style="text-align: left;"><code>1.76be323d7d041;-10a</code></td>
</tr>
</tbody>
</table>
<p>POSIX <code>"%a"</code> uses a hex mantissa (16), decimal exponent radix (10), and binary exponent base (2). The general normalized form requires that the integral part of the mantissa to exceed 0 and not to exceed <code>exponent base - 1</code> except in the special case of <code>0</code>. The sigil is <code>p</code> and exponent sign is always used.</p>
<p>JS <code>num.toString(radix)</code> is implementation-dependent for valid non-10 radices (<code>2-9, 11-36</code>). IE uses hex-mantissa decimal-hex-exponent form when the absolute value of the base-2 exponent exceeds 60. Otherwise, IE uses an exact standard hexadecimal form. Chrome, Safari and other browsers always use the exact standard hexadecimal form. Both forms are easily converted to <code>"%a"</code> by calculating and dividing by the appropriate power of 2.</p>
<p>For each non-zero normal floating point value, there are 4 acceptable strings that represent the value, derived by multiplying the normalized value by powers of 2 and adjusting the exponent accordingly:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Value</th>
<th style="text-align: left;">Normalized</th>
<th style="text-align: left;">Alternate <code>*2</code></th>
<th style="text-align: left;">Alternate <code>*4</code></th>
<th style="text-align: left;">Alternate <code>*8</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>1</code></td>
<td style="text-align: left;"><code>1p+0</code></td>
<td style="text-align: left;"><code>2p-1</code></td>
<td style="text-align: left;"><code>4p-2</code></td>
<td style="text-align: left;"><code>8p-3</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.2</code></td>
<td style="text-align: left;"><code>1.9999999p-3</code></td>
<td style="text-align: left;"><code>3.3333333p-4</code></td>
<td style="text-align: left;"><code>6.6666666p-5</code></td>
<td style="text-align: left;"><code>c.cccccccp-6</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.69</code></td>
<td style="text-align: left;"><code>1.6147ae1p-1</code></td>
<td style="text-align: left;"><code>2.c28f5c2p-2</code></td>
<td style="text-align: left;"><code>5.851eb85p-3</code></td>
<td style="text-align: left;"><code>b.0a3d70ap-4</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>6.e20</code></td>
<td style="text-align: left;"><code>1.043561p+69</code></td>
<td style="text-align: left;"><code>2.086ac3p+68</code></td>
<td style="text-align: left;"><code>4.10d586p+67</code></td>
<td style="text-align: left;"><code>8.21ab0dp+66</code></td>
</tr>
</tbody>
</table>
<p>JS engines follow the glibc model: multiply by a suitable power of 16 so that the mantissa is between 1 and 16, render left to right one digit at a time, then fix the result at the end. FreeBSD and OSX always show the normalized form. This implementation defaults to the normalized form. To switch to the glibc form, define <code>DO_NOT_NORMALIZE</code> in the <code>JSFLAGS</code> variable when building:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb24-1" title="1">$ <span class="va">JSFLAGS=</span>-DDO_NOT_NORMALIZE <span class="fu">make</span></a></code></pre></div>
<h1 id="character-conversions">Character Conversions</h1>
<p>This section covers the conversions <code>sScC</code>.</p>
<h2 id="rendering-strings-s-and-s-conversions">Rendering Strings (“s” and “S” conversions)</h2>
<p>JS has no concept of “wide strings” (<code>wchar_t *</code> in C), so the length modifiers are ignored. <code>s</code> and <code>S</code> are treated as equivalent.</p>
<p>Arguments are first interpreted as strings by calling the <code>String</code> function. Implementing <code>toString</code> on the argument to be converted may lead to unexpected results:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb25-1" title="1">var O = {valueOf:function() {<span class="cf">return</span> <span class="dv">456</span>;}, toString:function() {<span class="cf">return</span> <span class="st">&quot;123&quot;</span>}};</a>
<a class="sourceLine" id="cb25-2" title="2">printf(<span class="st">&quot;%1$s %1$d&quot;</span>, O); <span class="co">// &quot;123 456&quot;</span></a></code></pre></div>
<p>If a positive precision is specified, up to that many characters will be taken from the string. Otherwise the entire string will be used:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb26-1" title="1">printf(<span class="st">&quot;|%s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);    <span class="co">// &#39;|sheetjs|&#39; (no precision)</span></a>
<a class="sourceLine" id="cb26-2" title="2">printf(<span class="st">&quot;|%.9s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);  <span class="co">// &#39;|sheetjs|&#39; (string shorter than precision)</span></a>
<a class="sourceLine" id="cb26-3" title="3">printf(<span class="st">&quot;|%.5s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);  <span class="co">// &#39;|sheet|&#39;   (string truncated)</span></a></code></pre></div>
<p>Lengths are measured using the JS string length accessor. Since there is no attempt to correct for multi-character sequences like combining marks, the results may be unexpected:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb27-1" title="1">printf(<span class="st">&quot;%.1s&quot;</span>,<span class="st">&quot;ñ&quot;</span>);  <span class="co">// &#39;n&#39; not &quot;ñ&quot;</span></a></code></pre></div>
<p>If the width is specified and is greater than the width of the string to be rendered, padding will be applied. If the <code>"-"</code> flag is specified, then the string will be right-padded, otherwise it will be left-padded. If the <code>"0"</code> flag is specified, the final string is left-padded with zeroes. The <code>"-"</code> flag takes precedence over <code>0</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb28-1" title="1">printf(   <span class="st">&quot;|%s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|sheetjs|&#39;   (no width)</span></a>
<a class="sourceLine" id="cb28-2" title="2">printf(  <span class="st">&quot;|%5s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|sheetjs|&#39;   (string longer than width)</span></a>
<a class="sourceLine" id="cb28-3" title="3">printf(  <span class="st">&quot;|%9s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|  sheetjs|&#39; (no flag = left pad spaces)</span></a>
<a class="sourceLine" id="cb28-4" title="4">printf( <span class="st">&quot;|%09s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|00sheetjs|&#39; (&quot;0&quot; = left pad &quot;0&quot;)</span></a>
<a class="sourceLine" id="cb28-5" title="5">printf( <span class="st">&quot;|%-9s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|sheetjs  |&#39; (&quot;-&quot; = right pad space)</span></a>
<a class="sourceLine" id="cb28-6" title="6">printf(<span class="st">&quot;|%-09s|&quot;</span>, <span class="st">&quot;sheetjs&quot;</span>);   <span class="co">// &#39;|sheetjs  |&#39; (&quot;0&quot; ignored)</span></a></code></pre></div>
<h2 id="rendering-characters-c-and-c-conversions">Rendering Characters (“c” and “C” conversions)</h2>
<p>JS has no concept of “wide characters” (<code>wchar_t</code> in C). The length modifier is used in determining whether the number should be interpreted as one or two 16-bit character codes (when the “C” format or the “l” or “ll” specifiers are used) or a single 8-bit char code. Precision and flags are ignored.</p>
<h1 id="non-numeric-conversions">Non-Numeric Conversions</h1>
<h2 id="the-literal-symbol-conversion">The literal “%” symbol (“%” conversion)</h2>
<p>All other parameters are ignored.</p>
<h2 id="interpreting-and-rendering-pointers-p-conversion">Interpreting and Rendering Pointers (“p” conversion)</h2>
<p>JS has no true concept of pointers. In array and typed array contexts, it is common to associate a position object that stores the address relative to the start of the array. This implementation reads the <code>l</code> key and interprets as a 32-bit or 52-bit unsigned integer depending on <code>size_t</code> in the data model.</p>
<p>The normal output format is equivalent to <code>"%#x"</code> but the alternate form emits using the <code>"%d"</code> format. When the pointer is invalid, <code>-1</code> is rendered. Only the <code>"#"</code> flag is interpreted.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">var</span> x <span class="op">=</span> <span class="op">{},</span> y <span class="op">=</span> <span class="op">{</span><span class="dt">l</span><span class="op">:</span><span class="dv">3</span><span class="op">};</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="at">printf</span>(<span class="st">&quot;%1$p %1$#p&quot;</span><span class="op">,</span> y)<span class="op">;</span> <span class="co">// 0x3 3</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="at">printf</span>(<span class="st">&quot;%1$p %1$#p&quot;</span><span class="op">,</span> x)<span class="op">;</span> <span class="co">// 0xFFFFFFFF -1</span></a></code></pre></div>
<h2 id="extracting-length-of-a-partial-conversion-n-conversion">Extracting length of a partial conversion (“n” conversion)</h2>
<p>C <code>printf</code> permits a special <code>n</code> conversion which interprets the argument as an integral pointer (interpreted size controlled by the length specifier) and writes the number of characters printed to that pointer.</p>
<p>JS has no true concept of pointers in the C sense. The library works around the limitation by interpreting the argument as an object and assigning to the <code>len</code> key. The conversion does not write any characters to the output string:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">var</span> x <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="at">printf</span>(<span class="st">&quot;%1$s %2$J%2$n abc&quot;</span><span class="op">,</span> <span class="st">&quot;foo&quot;</span><span class="op">,</span> x)<span class="op">;</span> <span class="co">// &quot;foo {} abc&quot;, also sets x.len = 6</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">//     |........|                         |......|  (6 chars at that point)</span></a></code></pre></div>
<p>This implementation mutates the object while processing:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">var</span> x <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="at">printf</span>(<span class="st">&quot;%1$s %2$J%2$n %3$s %2$J&quot;</span><span class="op">,</span> <span class="st">&quot;foo&quot;</span><span class="op">,</span> x<span class="op">,</span> <span class="st">&quot;bar&quot;</span>)<span class="op">;</span> <span class="co">// &#39;foo {} bar {&quot;len&quot;:6}&#39;</span></a></code></pre></div>
<h2 id="error-messages-m-conversion">Error messages (“m” conversion)</h2>
<p>glibc supports an <code>m</code> conversion that does not consume arguments. It renders the string <code>strerror(errno)</code> where <code>strerror</code> is the libc function and <code>errno</code> is the global error number.</p>
<p>JS has no equivalent of <code>errno</code> and no standard JS runtime exposes a similar global error variable, so <code>%m</code> will write the default message <code>"Success"</code>. A positional parameter or <code>#</code> flag changes the behavior:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">form</th>
<th style="text-align: center;">position</th>
<th>behavior</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">main</td>
<td style="text-align: center;">no</td>
<td>do not read argument, emit “Success”</td>
</tr>
<tr class="even">
<td style="text-align: center;">alt (flag #)</td>
<td style="text-align: center;">no</td>
<td>read and process next argument</td>
</tr>
<tr class="odd">
<td style="text-align: center;">main or alt</td>
<td style="text-align: center;">yes</td>
<td>read and process specified argument</td>
</tr>
</tbody>
</table>
<p>In all forms other than <code>"%m"</code>, an argument will be processed as follows:</p>
<ul>
<li>If the argument is not an instance of an <code>Error</code>, emit “Success”</li>
<li>If the <code>message</code> field is set, emit the error message.</li>
<li>If the <code>errno</code> field is set, emit “Error number” followed by the errno</li>
<li>Otherwise emit “Error” followed by the error interpreted as a String</li>
</ul>
<pre><code>var x = new Error(&quot;sheetjs&quot;);
x.errno = 69; x.toString = function() { return &quot;SHEETJS&quot;; };
printf(&quot;|%#m|&quot;, x);      // |sheetjs|
delete x.message;
printf(&quot;|%#m|&quot;, x);      // |Error number 69|
delete x.errno;
printf(&quot;|%#m|&quot;, x);      // |Error SHEETJS|</code></pre>
<h1 id="extensions">Extensions</h1>
<p>These additional conversions take advantage of unused format characters:</p>
<h2 id="rendering-boolean-values-y-and-y-conversions">Rendering Boolean Values (“y” and “Y” conversions)</h2>
<p>Values are converted to Boolean and tested for truthiness. The <code>Y</code> rendering is the uppercase version of the equivalent rendering with format <code>y</code>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">form</th>
<th style="text-align: center;">truthy value <code>y</code> (<code>Y</code>)</th>
<th style="text-align: center;">falsy value <code>y</code> (<code>Y</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">main</td>
<td style="text-align: center;"><code>true</code> (<code>TRUE</code>)</td>
<td style="text-align: center;"><code>false</code> (<code>FALSE</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">alt (flag #)</td>
<td style="text-align: center;"><code>yes</code> (<code>YES</code>)</td>
<td style="text-align: center;"><code>no</code> (<code>NO</code>)</td>
</tr>
</tbody>
</table>
<p>Width and precision are applied in the same manner as the <code>s</code> conversion.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="at">printf</span>(<span class="st">&quot;|%1$y|%2$Y|%1$#Y|%2$#y|%2$.1y|&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span> <span class="co">// |true|FALSE|YES|no|f|</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="at">printf</span>(<span class="st">&quot;|%05.2Y|%-5.2y|&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span>  <span class="co">// |000TR|fa   |</span></a></code></pre></div>
<h2 id="rendering-json-j-conversion">Rendering JSON (“J” conversion)</h2>
<p>The default rendering is the standard output from <code>JSON.stringify</code>. Alternate form (<code>"#"</code> flag) renders using <code>util.inspect</code> if available.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">var</span> x <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb34-2" title="2">  <span class="dt">a</span><span class="op">:</span> [<span class="dv">1</span><span class="op">,</span>[<span class="dv">2</span><span class="op">,</span><span class="dv">3</span><span class="op">,</span><span class="dv">4</span>]<span class="op">,</span><span class="dv">5</span><span class="op">,</span><span class="dv">6</span><span class="op">,</span><span class="dv">7</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb34-3" title="3">  <span class="dt">b</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb34-4" title="4">    <span class="dt">c</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb34-5" title="5">      <span class="dt">d</span><span class="op">:</span> <span class="op">{</span> <span class="dt">e</span><span class="op">:</span><span class="st">&quot;f&quot;</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb34-6" title="6">      <span class="dt">g</span><span class="op">:</span><span class="st">&quot;h&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb34-7" title="7">      <span class="dt">i</span><span class="op">:</span><span class="st">&quot;j&quot;</span></a>
<a class="sourceLine" id="cb34-8" title="8">    <span class="op">},</span></a>
<a class="sourceLine" id="cb34-9" title="9">    <span class="dt">k</span><span class="op">:</span><span class="st">&quot;l&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb34-10" title="10">    <span class="dt">m</span><span class="op">:</span><span class="st">&quot;n&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb34-11" title="11">    <span class="dt">o</span><span class="op">:</span><span class="st">&quot;p&quot;</span><span class="op">},</span></a>
<a class="sourceLine" id="cb34-12" title="12">  <span class="dt">q</span><span class="op">:</span> <span class="st">&quot;r&quot;</span></a>
<a class="sourceLine" id="cb34-13" title="13"><span class="op">};</span></a>
<a class="sourceLine" id="cb34-14" title="14"><span class="at">printf</span>(<span class="st">&quot;%J&quot;</span><span class="op">,</span> x) <span class="co">// &#39;{&quot;a&quot;:[1,[2,3,4],5,6,7],&quot;b&quot;:{&quot;c&quot;:{&quot;d&quot;:{&quot;e&quot;:&quot;f&quot;}, ..(ctnd)..</span></a>
<a class="sourceLine" id="cb34-15" title="15"><span class="at">printf</span>(<span class="st">&quot;%#J&quot;</span><span class="op">,</span> x) <span class="co">// &#39;{ a: [ 1, [ 2, 3, 4 ], 5, 6, 7 ],\n  b: { c: { ..(ctnd)..</span></a></code></pre></div>
<p>Width, precision and other flags are ignored.</p>
<h2 id="js-typeof-and-valueof-t-and-v-conversion">JS typeof and valueOf (“T” and “V” conversion)</h2>
<p>Under the “T” conversion, the result of <code>typeof arg</code> is rendered. If the <code>#</code> flag is specified, the type is derived from <code>Object.prototype.toString</code>:</p>
<pre><code>printf(&quot;%1$T %1$#T&quot;, 1);          // &#39;number Number&#39;
printf(&quot;%1$T %1$#T&quot;, &#39;foo&#39;);      // &#39;string String&#39;
printf(&quot;%1$T %1$#T&quot;, [1,2,3]);    // &#39;object Array&#39;
printf(&quot;%1$T %1$#T&quot;, null);       // &#39;object Null&#39;
printf(&quot;%1$T %1$#T&quot;, undefined);  // &#39;undefined Undefined&#39;</code></pre>
<p>Under the “V” conversion, the result of <code>arg.valueOf()</code> is rendered:</p>
<pre><code>var _f = function() { return &quot;f&quot;; };
var _3 = function() { return 3; };
printf(&quot;%1$d %1$s %1$V&quot;, {toString:_f});               // &#39;0 f f&#39;
printf(&quot;%1$d %1$s %1$V&quot;, {valueOf:_3});                // &#39;3 [object Object] 3&#39;
printf(&quot;%1$d %1$s %1$V&quot;, {valueOf:_3, toString:_f});   // &#39;3 f 3&#39;</code></pre>
<h2 id="rendering-unsigned-integers-in-base-2-b-and-b-conversions">Rendering Unsigned Integers in Base 2 (“b” and “B” conversions)</h2>
<p>The implementation is similar to the octal <code>"o"</code> and <code>"O"</code> conversions, except for the radix (2 for <code>"b"</code> and <code>"B"</code>) and the alternate-form prefix (<code>"0b"</code>)</p>
<h1 id="miscellaneous-notes">Miscellaneous Notes</h1>
<h2 id="format-characters">Format Characters</h2>
<p>For compatibility purposes, format characters must be printable ASCII characters (ASCII codes <code>0x20 - 0x7E</code>). The 95 eligible characters are listed below:</p>
<table>
<thead>
<tr class="header">
<th>C</th>
<th style="text-align: center;">Type</th>
<th>C</th>
<th style="text-align: center;">Type</th>
<th>C</th>
<th style="text-align: center;">Type</th>
<th>C</th>
<th style="text-align: center;">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>a</code></td>
<td style="text-align: center;">conversion</td>
<td><code>A</code></td>
<td style="text-align: center;">conversion</td>
<td><code></code></td>
<td style="text-align: center;">flag</td>
<td><code>!</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>b</code></td>
<td style="text-align: center;">conversion</td>
<td><code>B</code></td>
<td style="text-align: center;">conversion</td>
<td><code>"</code></td>
<td style="text-align: center;"></td>
<td><code>#</code></td>
<td style="text-align: center;">flag</td>
</tr>
<tr class="odd">
<td><code>c</code></td>
<td style="text-align: center;">conversion</td>
<td><code>C</code></td>
<td style="text-align: center;">conversion</td>
<td><code>$</code></td>
<td style="text-align: center;">other</td>
<td><code>%</code></td>
<td style="text-align: center;">conversion</td>
</tr>
<tr class="even">
<td><code>d</code></td>
<td style="text-align: center;">conversion</td>
<td><code>D</code></td>
<td style="text-align: center;">conversion</td>
<td><code>&amp;</code></td>
<td style="text-align: center;"></td>
<td><code>'</code></td>
<td style="text-align: center;">flag</td>
</tr>
<tr class="odd">
<td><code>e</code></td>
<td style="text-align: center;">conversion</td>
<td><code>E</code></td>
<td style="text-align: center;">conversion</td>
<td><code>(</code></td>
<td style="text-align: center;"></td>
<td><code>)</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>f</code></td>
<td style="text-align: center;">conversion</td>
<td><code>F</code></td>
<td style="text-align: center;">conversion</td>
<td><code>*</code></td>
<td style="text-align: center;">other</td>
<td><code>+</code></td>
<td style="text-align: center;">flag</td>
</tr>
<tr class="odd">
<td><code>g</code></td>
<td style="text-align: center;">conversion</td>
<td><code>G</code></td>
<td style="text-align: center;">conversion</td>
<td><code>,</code></td>
<td style="text-align: center;"></td>
<td><code>-</code></td>
<td style="text-align: center;">flag</td>
</tr>
<tr class="even">
<td><code>h</code></td>
<td style="text-align: center;">length</td>
<td><code>H</code></td>
<td style="text-align: center;"></td>
<td><code>.</code></td>
<td style="text-align: center;">other</td>
<td><code>/</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>i</code></td>
<td style="text-align: center;">conversion</td>
<td><code>I</code></td>
<td style="text-align: center;">length</td>
<td><code>0</code></td>
<td style="text-align: center;">digit</td>
<td><code>1</code></td>
<td style="text-align: center;">digit</td>
</tr>
<tr class="even">
<td><code>j</code></td>
<td style="text-align: center;">length</td>
<td><code>J</code></td>
<td style="text-align: center;">conversion</td>
<td><code>2</code></td>
<td style="text-align: center;">digit</td>
<td><code>3</code></td>
<td style="text-align: center;">digit</td>
</tr>
<tr class="odd">
<td><code>k</code></td>
<td style="text-align: center;"></td>
<td><code>K</code></td>
<td style="text-align: center;"></td>
<td><code>4</code></td>
<td style="text-align: center;">digit</td>
<td><code>5</code></td>
<td style="text-align: center;">digit</td>
</tr>
<tr class="even">
<td><code>l</code></td>
<td style="text-align: center;">length</td>
<td><code>L</code></td>
<td style="text-align: center;">length</td>
<td><code>6</code></td>
<td style="text-align: center;">digit</td>
<td><code>7</code></td>
<td style="text-align: center;">digit</td>
</tr>
<tr class="odd">
<td><code>m</code></td>
<td style="text-align: center;">conversion</td>
<td><code>M</code></td>
<td style="text-align: center;"></td>
<td><code>8</code></td>
<td style="text-align: center;">digit</td>
<td><code>9</code></td>
<td style="text-align: center;">digit</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td style="text-align: center;">conversion</td>
<td><code>N</code></td>
<td style="text-align: center;"></td>
<td><code>:</code></td>
<td style="text-align: center;"></td>
<td><code>;</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>o</code></td>
<td style="text-align: center;">conversion</td>
<td><code>O</code></td>
<td style="text-align: center;">conversion</td>
<td><code>&lt;</code></td>
<td style="text-align: center;"></td>
<td><code>=</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>p</code></td>
<td style="text-align: center;">conversion</td>
<td><code>P</code></td>
<td style="text-align: center;"></td>
<td><code>&gt;</code></td>
<td style="text-align: center;"></td>
<td><code>?</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>q</code></td>
<td style="text-align: center;">length</td>
<td><code>Q</code></td>
<td style="text-align: center;"></td>
<td><code>@</code></td>
<td style="text-align: center;"></td>
<td><code>[</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>r</code></td>
<td style="text-align: center;"></td>
<td><code>R</code></td>
<td style="text-align: center;"></td>
<td><code>\</code></td>
<td style="text-align: center;"></td>
<td><code>]</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>s</code></td>
<td style="text-align: center;">conversion</td>
<td><code>S</code></td>
<td style="text-align: center;">conversion</td>
<td><code>^</code></td>
<td style="text-align: center;"></td>
<td><code>_</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>t</code></td>
<td style="text-align: center;">length</td>
<td><code>T</code></td>
<td style="text-align: center;">conversion</td>
<td><code>~</code></td>
<td style="text-align: center;"></td>
<td><code>{</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>u</code></td>
<td style="text-align: center;">conversion</td>
<td><code>U</code></td>
<td style="text-align: center;">conversion</td>
<td><code>|</code></td>
<td style="text-align: center;"></td>
<td><code>}</code></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>v</code></td>
<td style="text-align: center;"></td>
<td><code>V</code></td>
<td style="text-align: center;">conversion</td>
<td><code>`</code></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>w</code></td>
<td style="text-align: center;">length</td>
<td><code>W</code></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>x</code></td>
<td style="text-align: center;">conversion</td>
<td><code>X</code></td>
<td style="text-align: center;">conversion</td>
<td></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td><code>y</code></td>
<td style="text-align: center;">conversion</td>
<td><code>Y</code></td>
<td style="text-align: center;">conversion</td>
<td></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td><code>z</code></td>
<td style="text-align: center;">length</td>
<td><code>Z</code></td>
<td style="text-align: center;">length</td>
<td></td>
<td style="text-align: center;"></td>
<td></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<h2 id="js-and-c-strings-1">JS and C strings</h2>
<p>C provides no guidance on the actual character set. According to K&amp;R all valid characters in source code must be in a character set that is a subset of the 7-bit ASCII set. This implementation falls back on the UTF-16 base required by JS. When converting C literal strings, there are a few differences in escaping:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">C escape sequence</th>
<th style="text-align: left;">Equivalent JS</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>"\a"</code></td>
<td style="text-align: left;"><code>"\007"</code></td>
<td style="text-align: left;">BEL character will not ring in browser</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>"\?"</code></td>
<td style="text-align: left;"><code>"?"</code></td>
<td style="text-align: left;">JS does not handle trigraphs</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>"\ooo"</code> (octal)</td>
<td style="text-align: left;"><code>"\ooo"</code></td>
<td style="text-align: left;">JS uses Latin-1 for non-ASCII codes</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>"\xhh"</code> (hex)</td>
<td style="text-align: left;"><code>"\xhh"</code></td>
<td style="text-align: left;">JS uses Latin-1 for non-ASCII codes</td>
</tr>
</tbody>
</table>
<h2 id="browser-deviations">Browser Deviations</h2>
<p>Opera does not always include the last significant digit in base 16 rendering. For example, <code>(-6.9e-11).toString(16)</code> is <code>"0.000000004bddc5fd160168"</code> in every other browser but is <code>"0.000000004bddc5fd16017"</code> in Opera. The test suite skips the <code>%a/%A</code> precision-less formats in Opera.</p>
<p><code>Object.prototype.toString.call</code> gives unexpected results in older browsers, and no attempt is made to correct for them. The test suite ignores those cases:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">value</th>
<th style="text-align: left;"><code>%#T</code> expected</th>
<th style="text-align: left;"><code>%#T</code> IE &lt; 9</th>
<th style="text-align: left;"><code>%#T</code> Android &lt; 4.4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>null</code></td>
<td style="text-align: left;"><code>"Null"</code></td>
<td style="text-align: left;"><code>"Object"</code></td>
<td style="text-align: left;"><code>"global"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>undefined</code></td>
<td style="text-align: left;"><code>"Undefined"</code></td>
<td style="text-align: left;"><code>"Object"</code></td>
<td style="text-align: left;"><code>"global"</code></td>
</tr>
</tbody>
</table>
<h2 id="support-summary">Support Summary</h2>
<ul>
<li>Full <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html">POSIX</a> conversion support with extensions! <a href="#conversion-specifier-quick-reference-table">Conversion Specifier Table</a></li>
<li>Full support for POSIX flags and positional parameters</li>
<li>Emulation of BSD <code>quad_t</code> and <code>u_quad_t</code> conversion</li>
<li>Parser accepts but does not emulate CRT wide and unicode character conversions</li>
<li>glibc <code>Z</code> length conversion and extended <code>m</code> error support</li>
<li>Parser fails on CRT <code>I32</code>/<code>I64</code> fixed lengths</li>
<li>Default <code>LP64</code> data model but can be configured to support <code>ILP32</code> or <code>LLP64</code></li>
</ul>
