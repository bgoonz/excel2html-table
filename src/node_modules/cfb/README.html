<h1 id="compound-file-binary-format">Compound File Binary Format</h1>
<p>This is a Pure-JS implementation of MS-CFB: Compound File Binary File Format, a format used in many Microsoft file types (such as XLS and DOC)</p>
<h1 id="utility-installation-and-usage">Utility Installation and Usage</h1>
<p>The package is available on NPM:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1">$ <span class="ex">npm</span> install -g cfb</a>
<a class="sourceLine" id="cb1-2" title="2">$ <span class="ex">cfb</span> path/to/CFB/file</a></code></pre></div>
<p>The command will extract the storages and streams in the container, generating files that line up with the tree-based structure of the storage. Metadata such as the red-black tree are discarded.</p>
<h1 id="library-installation-and-usage">Library Installation and Usage</h1>
<p>In the browser:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;cfb.js&quot;</span><span class="ot"> type=</span><span class="st">&quot;text/javascript&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a></code></pre></div>
<p>In node:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> CFB <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;cfb&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>For example, to get the Workbook content from an XLS file:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> cfb <span class="op">=</span> <span class="va">CFB</span>.<span class="at">read</span>(filename<span class="op">,</span> <span class="op">{</span><span class="dt">type</span><span class="op">:</span> <span class="st">&#39;file&#39;</span><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">var</span> workbook <span class="op">=</span> <span class="va">cfb</span>.<span class="at">find</span>(<span class="st">&#39;Workbook&#39;</span>)</a></code></pre></div>
<h1 id="api">API</h1>
<p>Typescript definitions are maintained in <code>misc/cfb.d.ts</code>.</p>
<p>The CFB object exposes the following methods and properties:</p>
<p><code>CFB.parse(blob)</code> takes a nodejs Buffer or an array of bytes and returns an parsed representation of the data.</p>
<p><code>CFB.read(blob, options)</code> wraps <code>parse</code>. <code>options.type</code> controls the behavior:</p>
<ul>
<li><code>file</code>: <code>blob</code> should be a file name</li>
<li><code>base64</code>: <code>blob</code> should be a base64 string</li>
<li><code>binary</code>: <code>blob</code> should be a binary string</li>
</ul>
<h2 id="container-object-description">Container Object Description</h2>
<p>The object returned by <code>parse</code> and <code>read</code> can be found in the source (<code>rval</code>). It has the following properties and methods:</p>
<ul>
<li><p><code>.find(path)</code> performs a case-insensitive match for the path (or file name, if there are no slashes) and returns an entry object (described later) or null if not found</p></li>
<li><p><code>.FullPaths</code> is an array of the names of all of the streams (files) and storages (directories) in the container. The paths are properly prefixed from the root entry (so the entries are unique)</p></li>
<li><p><code>.FullPathDir</code> is an object whose keys are entries in <code>.FullPaths</code> and whose values are objects with metadata and content (described below)</p></li>
<li><p><code>.FileIndex</code> is an array of the objects from <code>.FullPathDir</code>, in the same order as <code>.FullPaths</code>.</p></li>
<li><p><code>.raw</code> contains the raw header and sectors</p></li>
</ul>
<h2 id="entry-object-description">Entry Object Description</h2>
<p>The entry objects are available from <code>FullPathDir</code> and <code>FileIndex</code> elements of the container object.</p>
<ul>
<li><code>.name</code> is the (case sensitive) internal name</li>
<li><code>.type</code> is the type as defined in “Object Type” in [MS-CFB] 2.6.1: <code>2 (stream)</code> for files, <code>1 (storage)</code> for dirs, <code>5 (root)</code> for root)</li>
<li><code>.content</code> is a Buffer/Array with the raw content</li>
<li><code>.ct</code>/<code>.mt</code> are the creation and modification time (if provided in file)</li>
</ul>
<h1 id="notes">Notes</h1>
<p>Case comparison has not been verified for non-ASCII characters</p>
<p>Writing is not supported. It is in the works, but it has not yet been released.</p>
<p>The <code>xlscfb.js</code> file is designed to be embedded in <a href="http://git.io/xlsx">js-xlsx</a></p>
<h1 id="license">License</h1>
<p>This implementation is covered under Apache 2.0 license. It complies with the <a href="http://www.microsoft.com/openspecifications/">Open Specifications Promise</a></p>
<p><a href="https://travis-ci.org/SheetJS/js-cfb"><img src="https://travis-ci.org/SheetJS/js-cfb.svg?branch=master" alt="Build Status" /></a></p>
<p><a href="https://coveralls.io/r/SheetJS/js-cfb?branch=master"><img src="http://img.shields.io/coveralls/SheetJS/js-cfb/master.svg" alt="Coverage Status" /></a></p>
<p><a href="https://github.com/SheetJS/js-cfb"><img src="https://ga-beacon.appspot.com/UA-36810333-1/SheetJS/js-cfb?pixel" alt="Analytics" /></a></p>
<p><a href="https://npmjs.org/package/cfb"><img src="https://img.shields.io/npm/dt/cfb.svg" alt="NPM Downloads" /></a></p>
<p><a href="https://david-dm.org/sheetjs/js-cfb"><img src="https://david-dm.org/sheetjs/js-cfb/status.svg" alt="Dependencies Status" /></a></p>
<p><a href="https://ghit.me/repo/sheetjs/js-cfb"><img src="https://ghit.me/badge.svg?repo=sheetjs/js-cfb" alt="ghit.me" /></a></p>
